<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>ode-plotter.esbook</title>
    <script defer type="module">
        const default_server_endpoint = 'https://blackguard.github.io/esbook/build/';
        const server_endpoint = new URL(location).searchParams.get('s') ?? default_server_endpoint;
        const loading_indicator_el = document.createElement('h1');
        loading_indicator_el.innerText = 'Loading...';
        document.body.insertBefore(loading_indicator_el, document.body.firstChild);
        try {
            await import(new URL('./src/init.js', server_endpoint));
        } catch (error) {
            document.body.innerHTML = '<h1>Failed to Load</h1><h2>Server endpoint: '+server_endpoint+'</h2><pre>'+error.stack+'</pre>';
        } finally {
            loading_indicator_el.remove();
        }
    </script>
</head>
<body>
<div id="initializing-data-f55c8878-87c8-11ec-b7c3-273bd5f809b1" style="display:none">
eyJuYl90eXBlIjoiZXNib29rIiwibmJfdmVyc2lvbiI6IjIuMC4wIiwiZWxlbWVudHMiOlt7ImlkIjoiaWQtNjVhZmU2YzktNjdhYi00NjQ2LWE1YWUtYTMwYWJmZWJhN2E0IiwiaW5wdXQiOiIvLyBhdXRvaGlkZVxuLy8gZXZhbHVhdGUgdGhpcyBlbnRpcmUgbm90ZWJvb2sgdG8gZ2V0IHN0YXJ0ZWQiLCJvdXRwdXQiOltdLCJmb3JtYXR0aW5nX29wdGlvbnMiOnsiYWxpZ24iOiJsZWZ0IiwiaW5kZW50IjoiMGVtIn19LHsiaWQiOiJpZC02MjU4Njg5Ni0yNmRiLTQ1NmYtYTkzMi0wMTBiNzQzNjllNzIiLCJpbnB1dCI6Ii8vIGF1dG9oaWRlXG5cbmNsYXNzIFdvcmtlclBvb2wge1xuICAgIGNvbnN0cnVjdG9yKHdvcmtlcl9jb3VudD1uYXZpZ2F0b3IuaGFyZHdhcmVDb25jdXJyZW5jeSkge1xuICAgICAgICBPYmplY3QuZGVmaW5lUHJvcGVydGllcyh0aGlzLCB7XG4gICAgICAgICAgICB3b3JrZXJfY291bnQ6IHtcbiAgICAgICAgICAgICAgICB2YWx1ZTogd29ya2VyX2NvdW50LFxuICAgICAgICAgICAgICAgIGVudW1lcmFibGU6IHRydWUsXG4gICAgICAgICAgICB9LFxuICAgICAgICB9KTtcbiAgICAgICAgdGhpcy5fd29ya2VycyA9IFtdO1xuICAgICAgICB0aGlzLl91cGRhdGVfcG9vbCgpO1xuICAgIH1cblxuICAgIGdldCB3b3JrZXJzICgpe1xuICAgICAgICBpZiAodGhpcy5fd29ya2Vycy5zb21lKHcgPT4gdy50ZXJtaW5hdGVkKSkge1xuICAgICAgICAgICAgdGhpcy5fdXBkYXRlX3Bvb2woKTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gdGhpcy5fd29ya2VycztcbiAgICB9XG5cbiAgICBfdXBkYXRlX3Bvb2woKSB7XG4gICAgICAgIHRoaXMuX3dvcmtlcnMgPSB0aGlzLl93b3JrZXJzLmZpbHRlcih3ID0+ICF3LnRlcm1pbmF0ZWQpO1xuICAgICAgICBmb3IgKGxldCBpID0gdGhpcy5fd29ya2Vycy5sZW5ndGg7IGkgPCB0aGlzLndvcmtlcl9jb3VudDsgaSsrKSB7XG4gICAgICAgICAgICB0aGlzLl93b3JrZXJzLnB1c2goY3JlYXRlX3dvcmtlcigpKTtcbiAgICAgICAgfVxuICAgIH1cbn07XG5cbnZhcnMoeyB3b3JrZXJfcG9vbDogdGhpcy5ldmFsX2NvbnRleHQud29ya2VyX3Bvb2wgPz8gbmV3IFdvcmtlclBvb2woKSB9KTsiLCJvdXRwdXQiOltdLCJmb3JtYXR0aW5nX29wdGlvbnMiOnsiYWxpZ24iOiJsZWZ0IiwiaW5kZW50IjoiMGVtIn19LHsiaWQiOiJpZC0yMjExMzdkNC00Y2MwLTQwMWUtOWQxMi04MGY3ODc4MTE0MGQiLCJpbnB1dCI6Ii8vIGF1dG9oaWRlXG5jb25zdCB7XG4gICAgUGxvdGx5LFxufSA9IGF3YWl0IGltcG9ydCgnLi9vdXRwdXQtaGFuZGxlcnMvcGxvdGx5LmpzJyk7XG5cbmNvbnN0IGh0bWwgPSBgXG48c3R5bGU+XG4gICAgI29kZV9wbG90dGVyX2luZm9fZGlzcGxheSB7XG4gICAgICAgIGRpc3BsYXk6IGZsZXg7XG4gICAgICAgIGdhcDogMnJlbTtcbiAgICB9XG5cbiAgICAjb2RlX3Bsb3R0ZXJfcGxheV9jb250cm9scyB7XG4gICAgICAgIHBhZGRpbmctdG9wOiAwLjVyZW07XG4gICAgICAgIHBhZGRpbmctYm90dG9tOiAwLjVyZW07XG4gICAgfVxuXG4gICAgI29kZV9wbG90dGVyX2NvbnRyb2xzIHtcbiAgICAgICAgd2lkdGg6IGZpdC1jb250ZW50O1xuICAgIH1cbiAgICAjb2RlX3Bsb3R0ZXJfY29udHJvbHMgZGl2ICoge1xuICAgICAgICB2ZXJ0aWNhbC1hbGlnbjogbWlkZGxlO1xuICAgIH1cblxuICAgICNvZGVfcGxvdHRlcl9hZGp1c3RtZW50cyB7XG4gICAgICAgIGRpc3BsYXk6IGdyaWQ7XG4gICAgICAgIGdyaWQtdGVtcGxhdGUtY29sdW1uczogbWF4LWNvbnRlbnQgbWF4LWNvbnRlbnQ7XG4gICAgICAgIGdhcDogMC41cmVtO1xuICAgIH1cbiAgICAjb2RlX3Bsb3R0ZXJfYWRqdXN0bWVudHMgbGFiZWwge1xuICAgICAgICBqdXN0aWZ5LXNlbGY6IGVuZDtcbiAgICB9XG5cbiAgICAjb2RlX3Bsb3R0ZXJfY29uZmlnX2Rpc3BsYXkge1xuICAgICAgICB3aWR0aDogZml0LWNvbnRlbnQ7XG4gICAgICAgIGZvbnQtZmFtaWx5OiBtb25vc3BhY2U7XG4gICAgfVxuXG4gICAgLm9kZV9wbG90dGVyX2Rpc3BsYXkge1xuICAgICAgICBtYXJnaW4tbGVmdDogMC4xcmVtO1xuICAgICAgICBwYWRkaW5nOiAwIDAuNXJlbTtcbiAgICAgICAgYmFja2dyb3VuZC1jb2xvcjogI2VlZTtcbiAgICB9XG5cbiAgICAuaGlkZGVuIHtcbiAgICAgICAgZGlzcGxheTogbm9uZTtcbiAgICB9XG48L3N0eWxlPlxuXG48ZGl2IGlkPVwib2RlX3Bsb3R0ZXJfcGxheV9jb250cm9sc1wiPlxuICAgIDxidXR0b24gaWQ9XCJvZGVfcGxvdHRlcl9nb1wiPkdvPC9idXR0b24+XG4gICAgPGJ1dHRvbiBpZD1cIm9kZV9wbG90dGVyX3BhdXNlXCIgY2xhc3M9XCJoaWRkZW5cIj5QYXVzZTwvYnV0dG9uPlxuPC9kaXY+XG48ZGl2IGlkPVwib2RlX3Bsb3R0ZXJfaW5mb19kaXNwbGF5XCI+XG4gICAgPGRpdiBpZD1cIm9kZV9wbG90dGVyX2NvbnRyb2xzXCI+XG4gICAgICAgIDxkaXYgaWQ9XCJvZGVfcGxvdHRlcl9hZGp1c3RtZW50c1wiPlxuICAgICAgICAgICAgPGxhYmVsIGZvcj1cInBvaW50c19wZXJfbG9vcFwiPlRpbWUgc3RlcHMgcGVyIGxvb3A8L2xhYmVsPlxuICAgICAgICAgICAgPGRpdj5cbiAgICAgICAgICAgICAgICA8aW5wdXQgaWQ9XCJwb2ludHNfcGVyX2xvb3BcIiB0eXBlPVwicmFuZ2VcIiBtaW49XCIxXCIgbWF4PVwiMTAwMDBcIiB2YWx1ZT1cIjEwMDBcIj5cbiAgICAgICAgICAgICAgICA8c3BhbiBpZD1cInBvaW50c19wZXJfbG9vcF9kaXNwbGF5XCIgY2xhc3M9XCJvZGVfcGxvdHRlcl9kaXNwbGF5XCI+PC9zcGFuPlxuICAgICAgICAgICAgPC9kaXY+XG4gICAgICAgICAgICA8bGFiZWwgZm9yPVwibG9vcF9kZWxheVwiPkxvb3AgZGVsYXk8L2xhYmVsPlxuICAgICAgICAgICAgPGRpdj5cbiAgICAgICAgICAgICAgICA8aW5wdXQgaWQ9XCJsb29wX2RlbGF5XCIgdHlwZT1cInJhbmdlXCIgbWluPVwiMFwiIG1heD1cIjUwMFwiIHZhbHVlPVwiNTBcIj5cbiAgICAgICAgICAgICAgICA8c3BhbiBpZD1cImxvb3BfZGVsYXlfZGlzcGxheVwiIGNsYXNzPVwib2RlX3Bsb3R0ZXJfZGlzcGxheVwiPjwvc3Bhbj4gbXNcbiAgICAgICAgICAgIDwvZGl2PlxuICAgICAgICAgICAgPGxhYmVsIGZvcj1cInBvaW50c19zaG93blwiPlRpbWUgc3RlcHMgc2hvd248L2xhYmVsPlxuICAgICAgICAgICAgPGRpdj5cbiAgICAgICAgICAgICAgICA8aW5wdXQgaWQ9XCJwb2ludHNfc2hvd25cIiB0eXBlPVwicmFuZ2VcIiBtaW49XCIwXCIgbWF4PVwiMTAwMDAwXCIgc3RlcD1cIjEwXCIgdmFsdWU9XCIyMDAwMFwiPlxuICAgICAgICAgICAgICAgIDxzcGFuIGlkPVwicG9pbnRzX3Nob3duX2Rpc3BsYXlcIiBjbGFzcz1cIm9kZV9wbG90dGVyX2Rpc3BsYXlcIj48L3NwYW4+XG4gICAgICAgICAgICA8L2Rpdj5cbiAgICAgICAgICAgIDxsYWJlbCBmb3I9XCJwb2ludF9jb3VudF9kaXNwbGF5XCI+VG90YWwgdGltZSBzdGVwczwvbGFiZWw+XG4gICAgICAgICAgICA8ZGl2PlxuICAgICAgICAgICAgICAgIDxzcGFuIGlkPVwicG9pbnRfY291bnRfZGlzcGxheVwiIGNsYXNzPVwib2RlX3Bsb3R0ZXJfZGlzcGxheVwiPjwvc3Bhbj5cbiAgICAgICAgICAgIDwvZGl2PlxuICAgICAgICAgICAgPGxhYmVsIGNsYXNzPVwiaGlkZGVuXCIgZm9yPVwicG9pbnRfY2xvdWRfbG9vcF9kaXNwbGF5XCI+UG9pbnQgY2xvdWQgc3RlcHM8L2xhYmVsPlxuICAgICAgICAgICAgPGRpdiBjbGFzcz1cImhpZGRlblwiPlxuICAgICAgICAgICAgICAgIDxzcGFuIGlkPVwicG9pbnRfY2xvdWRfbG9vcF9kaXNwbGF5XCIgY2xhc3M9XCJvZGVfcGxvdHRlcl9kaXNwbGF5XCI+PC9zcGFuPlxuICAgICAgICAgICAgPC9kaXY+XG4gICAgICAgIDwvZGl2PlxuICAgIDwvZGl2PlxuICAgIDxkaXYgaWQ9XCJvZGVfcGxvdHRlcl9jb25maWdfZGlzcGxheVwiPjwvZGl2PlxuPC9kaXY+XG48ZGl2IGlkPVwib2RlX3Bsb3R0ZXJfcGxvdFwiPjwvZGl2PlxuYDtcblxuZnVuY3Rpb24gc2V0dXAodGhlX291dHB1dF9jb250ZXh0LCB0aGVfZXF1YXRpb25fZGVmKSB7XG4gICAgdGhlX291dHB1dF9jb250ZXh0LmNyZWF0ZV9vdXRwdXRfZWxlbWVudCgpLmlubmVySFRNTCA9IGh0bWw7XG5cbiAgICBjb25zdCBwbG90X2VsID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ29kZV9wbG90dGVyX3Bsb3QnKTtcblxuICAgIGNvbnN0IGdvX2J1dHRvbiAgICA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdvZGVfcGxvdHRlcl9nbycpO1xuICAgIGNvbnN0IHBhdXNlX2J1dHRvbiA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdvZGVfcGxvdHRlcl9wYXVzZScpO1xuXG4gICAgZnVuY3Rpb24gc2V0X2dvX2J1dHRvbl9zdGF0ZShydW5uaW5nKSB7XG4gICAgICAgIGlmIChydW5uaW5nKSB7XG4gICAgICAgICAgICBnb19idXR0b24uaW5uZXJUZXh0ID0gJ1N0b3AnO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgZ29fYnV0dG9uLmlubmVyVGV4dCA9ICdHbyc7XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICBmdW5jdGlvbiBzZXRfcGF1c2VfYnV0dG9uX3N0YXRlKHBhdXNlZCwgcnVubmluZykge1xuICAgICAgICBwYXVzZV9idXR0b24uaW5uZXJUZXh0ID0gcGF1c2VkID8gJ1Jlc3VtZScgOiAnUGF1c2UnO1xuICAgICAgICBpZiAocnVubmluZykge1xuICAgICAgICAgICAgcGF1c2VfYnV0dG9uLmNsYXNzTGlzdC5yZW1vdmUoJ2hpZGRlbicpO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgcGF1c2VfYnV0dG9uLmNsYXNzTGlzdC5hZGQoJ2hpZGRlbicpO1xuICAgICAgICB9XG4gICAgfVxuICAgIHNldF9nb19idXR0b25fc3RhdGUoZmFsc2UpO1xuICAgIHNldF9wYXVzZV9idXR0b25fc3RhdGUoZmFsc2UsIGZhbHNlKTtcblxuICAgIGNvbnN0IHBvaW50c19wZXJfbG9vcF9lbCAgICAgICAgICA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdwb2ludHNfcGVyX2xvb3AnKTtcbiAgICBjb25zdCBsb29wX2RlbGF5X2VsICAgICAgICAgICAgICAgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnbG9vcF9kZWxheScpO1xuICAgIGNvbnN0IHBvaW50c19zaG93bl9lbCAgICAgICAgICAgICA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdwb2ludHNfc2hvd24nKTtcbiAgICBjb25zdCBwb2ludF9jb3VudF9kaXNwbGF5X2VsICAgICAgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgncG9pbnRfY291bnRfZGlzcGxheScpO1xuXG4gICAgZm9yIChjb25zdCByYW5nZV9pZCBvZiBbXG4gICAgICAgICdwb2ludHNfcGVyX2xvb3AnLFxuICAgICAgICAnbG9vcF9kZWxheScsXG4gICAgICAgICdwb2ludHNfc2hvd24nLFxuICAgIF0pIHtcbiAgICAgICAgY29uc3QgcmFuZ2VfZWwgICA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKHJhbmdlX2lkKTtcbiAgICAgICAgY29uc3QgZGlzcGxheV9lbCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKGAke3JhbmdlX2lkfV9kaXNwbGF5YCk7XG4gICAgICAgIGRpc3BsYXlfZWwuaW5uZXJUZXh0ID0gcmFuZ2VfZWwudmFsdWU7XG4gICAgICAgIHJhbmdlX2VsLmFkZEV2ZW50TGlzdGVuZXIoJ2lucHV0JywgKGV2ZW50KSA9PiB7XG4gICAgICAgICAgICBkaXNwbGF5X2VsLmlubmVyVGV4dCA9IHJhbmdlX2VsLnZhbHVlO1xuICAgICAgICB9KTtcbiAgICB9XG5cbiAgICBjb25zdCBwb2ludF9jbG91ZF9sb29wX2Rpc3BsYXlfZWwgICAgICAgID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3BvaW50X2Nsb3VkX2xvb3BfZGlzcGxheScpO1xuICAgIGNvbnN0IHBvaW50X2Nsb3VkX2xvb3BfZGlzcGxheV9wYXJlbnRfZWwgPSBwb2ludF9jbG91ZF9sb29wX2Rpc3BsYXlfZWwucGFyZW50RWxlbWVudDtcbiAgICBjb25zdCBwb2ludF9jbG91ZF9sb29wX2Rpc3BsYXlfbGFiZWxfZWwgID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignbGFiZWxbZm9yPVwicG9pbnRfY2xvdWRfbG9vcF9kaXNwbGF5XCInKTtcblxuICAgIGZ1bmN0aW9uIHNldF9wb2ludF9jbG91ZF9sb29wX2Rpc3BsYXkodmlzaWJsZSwgdmFsdWU9JycpIHtcbiAgICAgICAgcG9pbnRfY2xvdWRfbG9vcF9kaXNwbGF5LmlubmVyVGV4dCA9IHZhbHVlO1xuICAgICAgICBpZiAodmlzaWJsZSkge1xuICAgICAgICAgICAgcG9pbnRfY2xvdWRfbG9vcF9kaXNwbGF5X3BhcmVudF9lbC5jbGFzc0xpc3QucmVtb3ZlKCdoaWRkZW4nKTtcbiAgICAgICAgICAgIHBvaW50X2Nsb3VkX2xvb3BfZGlzcGxheV9sYWJlbF9lbC5jbGFzc0xpc3QucmVtb3ZlKCdoaWRkZW4nKTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIHBvaW50X2Nsb3VkX2xvb3BfZGlzcGxheV9wYXJlbnRfZWwuY2xhc3NMaXN0LmFkZCgnaGlkZGVuJyk7XG4gICAgICAgICAgICBwb2ludF9jbG91ZF9sb29wX2Rpc3BsYXlfbGFiZWxfZWwuY2xhc3NMaXN0LmFkZCgnaGlkZGVuJyk7XG4gICAgICAgIH1cbiAgICB9XG4gICAgc2V0X3BvaW50X2Nsb3VkX2xvb3BfZGlzcGxheShmYWxzZSk7XG5cbiAgICBjb25zdCBjb25maWdfZGlzcGxheV9lbCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdvZGVfcGxvdHRlcl9jb25maWdfZGlzcGxheScpO1xuXG4gICAgZnVuY3Rpb24gZGlzcGxheV9jb25maWcoY29uZmlnKSB7XG4gICAgICAgIGlmICghY29uZmlnKSB7XG4gICAgICAgICAgICBjb25maWdfZGlzcGxheV9lbC5jbGFzc0xpc3QuYWRkKCdoaWRkZW4nKTtcbiAgICAgICAgICAgIGNvbmZpZ19kaXNwbGF5X2VsLmlubmVyVGV4dCA9ICcnO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgY29uZmlnX2Rpc3BsYXlfZWwuY2xhc3NMaXN0LnJlbW92ZSgnaGlkZGVuJyk7XG4gICAgICAgICAgICBjb25zdCB7IGR0LCB4MCwgcGFyYW1zLCBza2lwLCBzdGVwcywgcG9pbnRfY2xvdWQgfSA9IGNvbmZpZztcbiAgICAgICAgICAgIGNvbnN0IGxpbmVzID0gW107XG4gICAgICAgICAgICBsaW5lcy5wdXNoKCctLS0gQ09ORklHIC0tLScpO1xuICAgICAgICAgICAgbGluZXMucHVzaChgZHQ6ICR7ZHR9YCk7XG4gICAgICAgICAgICBsaW5lcy5wdXNoKGB4MDogWyR7eDAuam9pbignLCAnKX1dYCk7XG4gICAgICAgICAgICBpZiAocGFyYW1zKSB7XG4gICAgICAgICAgICAgICAgbGV0IHBhcmFtc19zdHI7XG4gICAgICAgICAgICAgICAgaWYgKHR5cGVvZiBwYXJhbXMgPT09ICdvYmplY3QnKSB7XG4gICAgICAgICAgICAgICAgICAgIHRyeSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBwYXJhbXNfc3RyID0gSlNPTi5zdHJpbmdpZnkocGFyYW1zKTtcbiAgICAgICAgICAgICAgICAgICAgfSBjYXRjaCAoXykge1xuICAgICAgICAgICAgICAgICAgICAgICAgcGFyYW1zX3N0ciA9IHBhcmFtcy50b1N0cmluZygpO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgcGFyYW1zX3N0ciA9IHBhcmFtcy50b1N0cmluZygpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBsaW5lcy5wdXNoKGBwYXJhbXM6ICR7cGFyYW1zX3N0cn1gKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmIChza2lwKSB7XG4gICAgICAgICAgICAgICAgbGluZXMucHVzaChgc2tpcDogJHtza2lwfWApO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYgKHN0ZXBzKSB7XG4gICAgICAgICAgICAgICAgbGluZXMucHVzaChgc3RlcHM6ICR7c3RlcHN9YCk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpZiAocG9pbnRfY2xvdWQpIHtcbiAgICAgICAgICAgICAgICBjb25zdCB7IG4sIGMsIHIsIGR0OnBjX2R0PWR0LCBzdGVwczpwY19zdGVwcyB9ID0gcG9pbnRfY2xvdWQ7XG4gICAgICAgICAgICAgICAgbGluZXMucHVzaChgLS0tIHBvaW50IGNsb3VkIC0tLWApO1xuICAgICAgICAgICAgICAgIGxpbmVzLnB1c2goYG46ICR7bn0sIGM6IFske2Muam9pbignLCAnKX1dLCBkdDogJHtwY19kdH0ke3BjX3N0ZXBzID8gYCwgc3RlcHM6JHtwY19zdGVwc31gIDogJyd9fWApO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgY29uZmlnX2Rpc3BsYXlfZWwuaW5uZXJUZXh0ID0gbGluZXMuam9pbignXFxuJyk7XG4gICAgICAgIH1cbiAgICB9XG4gICAgZGlzcGxheV9jb25maWcoKTtcblxuICAgIGNvbnN0IHBsb3RfaGVpZ2h0ID0gNzIwO1xuICAgIHBsb3RfZWwuc3R5bGUgPSBgaGVpZ2h0OiAke3Bsb3RfaGVpZ2h0fXB4YDtcblxuICAgIGNvbnN0IEdlbmVyYXRvciA9IE9iamVjdC5nZXRQcm90b3R5cGVPZihmdW5jdGlvbiooKXt9KS5jb25zdHJ1Y3RvcjtcblxuICAgIGZ1bmN0aW9uIHZhbGlkYXRlX2YoZikge1xuICAgICAgICBpZiAodHlwZW9mIGYgIT09ICdmdW5jdGlvbicpIHtcbiAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcignZiBtdXN0IGJlIGEgZnVuY3Rpb24nKTtcbiAgICAgICAgfVxuICAgIH1cbiAgICBmdW5jdGlvbiB2YWxpZGF0ZV9pbnRlZ3JhdG9yKGludGVncmF0b3IpIHtcbiAgICAgICAgaWYgKHR5cGVvZiBpbnRlZ3JhdG9yICE9PSAnZnVuY3Rpb24nKSB7XG4gICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoJ2ludGVncmF0b3IgbXVzdCBiZSBhIGZ1bmN0aW9uJyk7XG4gICAgICAgIH1cbiAgICB9XG4gICAgZnVuY3Rpb24gdmFsaWRhdGVfcG9pbnRfY2xvdWQocG9pbnRfY2xvdWQpIHtcbiAgICAgICAgaWYgKCB0eXBlb2YgcG9pbnRfY2xvdWQgIT09ICdvYmplY3QnKSB7XG4gICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoJ3BvaW50X2Nsb3VkIG11c3QgYmUgYW4gb2JqZWN0JylcbiAgICAgICAgfVxuICAgICAgICBjb25zdCB7IG4sIGMsIHIsIGR0LCBzdGVwcyB9ID0gcG9pbnRfY2xvdWQ7XG4gICAgICAgIGlmICh0eXBlb2YgbiA9PT0gJ3VuZGVmaW5lZCcpIHtcbiAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcigncG9pbnRfY2xvdWQubiBtdXN0IGJlIGRlZmluZWQnKTtcbiAgICAgICAgfSBlbHNlIGlmICghTnVtYmVyLmlzSW50ZWdlcihuKSB8fCBuIDw9IDApIHtcbiAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcigncG9pbnRfY2xvdWQubiBtdXN0IGJlIGEgcG9zaXRpdmUgaW50ZWdlcicpO1xuICAgICAgICB9XG4gICAgICAgIGlmICh0eXBlb2YgYyA9PT0gJ3VuZGVmaW5lZCcpIHtcbiAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcigncG9pbnRfY2xvdWQuYyBtdXN0IGJlIGRlZmluZWQnKTtcbiAgICAgICAgfSBlbHNlIGlmICghQXJyYXkuaXNBcnJheShjKSB8fCBjLmxlbmd0aCA8PSAwIHx8IGMuc29tZShlID0+ICh0eXBlb2YgZSAhPT0gJ251bWJlcicpKSkge1xuICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKGBwb2ludF9jbG91ZC5jIG11c3QgYmUgYSBub24tZW1wdHkgYXJyYXkgb2YgbnVtYmVyc2ApO1xuICAgICAgICB9XG4gICAgICAgIGlmICh0eXBlb2YgciA9PT0gJ3VuZGVmaW5lZCcpIHtcbiAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcigncG9pbnRfY2xvdWQuciBtdXN0IGJlIGRlZmluZWQnKTtcbiAgICAgICAgfSBlbHNlIGlmICh0eXBlb2YgciAhPT0gJ251bWJlcicgfHwgciA8PSAwKSB7XG4gICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoJ3BvaW50X2Nsb3VkLnIgbXVzdCBiZSBhIHBvc2l0aXZlIG51bWJlcicpO1xuICAgICAgICB9XG4gICAgICAgIGlmICh0eXBlb2YgZHQgIT09ICd1bmRlZmluZWQnICYmICh0eXBlb2YgZHQgIT09ICdudW1iZXInIHx8IGR0IDw9IDApKSB7XG4gICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoYHBvaW50X2Nsb3VkLmR0IG11c3QgYmUgYSBwb3NpdGl2ZSBudW1iZXJgKTtcbiAgICAgICAgfVxuICAgICAgICBpZiAodHlwZW9mIHN0ZXBzICE9PSAndW5kZWZpbmVkJyAmJiAoIU51bWJlci5pc0ludGVnZXIoc3RlcHMpIHx8IHN0ZXBzIDwgMCkpIHtcbiAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcignc3RlcHMgcG9pbnRfY2xvdWRtdXN0IGJlIGEgbm9uLW5lZ2F0aXZlIGludGVnZXInKTtcbiAgICAgICAgfVxuICAgIH1cbiAgICBmdW5jdGlvbiB2YWxpZGF0ZV9jb25maWcoY29uZmlnLCBzdHJ1Y3R1cmVfbmFtZT0nY29uZmlnJykge1xuICAgICAgICBpZiAoIHR5cGVvZiBjb25maWcgIT09ICdvYmplY3QnKSB7XG4gICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoYCR7c3RydWN0dXJlX25hbWV9IG11c3QgYmUgYW4gb2JqZWN0YClcbiAgICAgICAgfVxuICAgICAgICBjb25zdCB7IGludGVncmF0b3IsIGR0LCB4MCwgc2tpcCwgc3RlcHMsIHBvaW50X2Nsb3VkIH0gPSBjb25maWc7ICAvLyBwYXJhbXMgaXMgdW5yZXN0cmljdGVkXG4gICAgICAgIGlmIChpbnRlZ3JhdG9yKSB7XG4gICAgICAgICAgICB2YWxpZGF0ZV9pbnRlZ3JhdG9yKGludGVncmF0b3IpO1xuICAgICAgICB9XG4gICAgICAgIGlmICh0eXBlb2YgZHQgIT09ICd1bmRlZmluZWQnICYmICh0eXBlb2YgZHQgIT09ICdudW1iZXInIHx8IGR0IDw9IDApKSB7XG4gICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoYCR7c3RydWN0dXJlX25hbWV9LmR0IG11c3QgYmUgYSBwb3NpdGl2ZSBudW1iZXJgKTtcbiAgICAgICAgfVxuICAgICAgICBpZiAodHlwZW9mIHgwICE9PSAndW5kZWZpbmVkJyAmJlxuICAgICAgICAgICAgICghQXJyYXkuaXNBcnJheSh4MCkgfHwgeDAubGVuZ3RoIDw9IDAgfHwgeDAuc29tZShlID0+ICh0eXBlb2YgZSAhPT0gJ251bWJlcicpKSkgKSB7XG4gICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoYCR7c3RydWN0dXJlX25hbWV9LngwIG11c3QgYmUgYSBub24tZW1wdHkgYXJyYXkgb2YgbnVtYmVyc2ApO1xuICAgICAgICB9XG4gICAgICAgIGlmICh0eXBlb2Ygc2tpcCAhPT0gJ3VuZGVmaW5lZCcgJiYgKCFOdW1iZXIuaXNJbnRlZ2VyKHNraXApIHx8IHNraXAgPCAwKSkge1xuICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKGAke3N0cnVjdHVyZV9uYW1lfS5za2lwIG11c3QgYmUgYSBub24tbmVnYXRpdmUgaW50ZWdlcmApO1xuICAgICAgICB9XG4gICAgICAgIGlmICh0eXBlb2Ygc3RlcHMgIT09ICd1bmRlZmluZWQnICYmICghTnVtYmVyLmlzSW50ZWdlcihzdGVwcykgfHwgc3RlcHMgPCAwKSkge1xuICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKGAke3N0cnVjdHVyZV9uYW1lfS5zdGVwcyBtdXN0IGJlIGEgbm9uLW5lZ2F0aXZlIGludGVnZXJgKTtcbiAgICAgICAgfVxuICAgICAgICBpZiAocG9pbnRfY2xvdWQpIHtcbiAgICAgICAgICAgIHZhbGlkYXRlX3BvaW50X2Nsb3VkKHBvaW50X2Nsb3VkKTtcbiAgICAgICAgfVxuICAgIH1cbiAgICBmdW5jdGlvbiB2YWxpZGF0ZV9lcXVhdGlvbl9kZWYoZXF1YXRpb25fZGVmKSB7XG4gICAgICAgIGlmICggdHlwZW9mIGVxdWF0aW9uX2RlZiAhPT0gJ29iamVjdCcpIHtcbiAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcignZXF1YXRpb24gZGVmaW5pdGlvbiBtdXN0IGJlIGFuIG9iamVjdCcpXG4gICAgICAgIH1cbiAgICAgICAgdmFsaWRhdGVfY29uZmlnKGVxdWF0aW9uX2RlZiwgJ2VxdWF0aW9uX2RlZicpOyAgLy8gZXF1YXRpb25fZGVmIGlzIGEgc3ViY2xhc3Mgb2YgY29uZmlnXG4gICAgICAgIGNvbnN0IHsgdGl0bGUsIGYsIGl0ZXIsIGl0ZXJfZGVsYXkgfSA9IGVxdWF0aW9uX2RlZjtcbiAgICAgICAgaWYgKHR5cGVvZiB0aXRsZSAhPT0gJ3VuZGVmaW5lZCcgJiYgdHlwZW9mIHRpdGxlICE9PSAnc3RyaW5nJykge1xuICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKCdlcXVhdGlvbl9kZWYudGl0bGUgbXVzdCBiZSBhIHN0cmluZycpO1xuICAgICAgICB9XG4gICAgICAgIGlmIChpdGVyKSB7XG4gICAgICAgICAgICBjb25zdCBpdGVyYXRvcl9mbiA9IGl0ZXJbU3ltYm9sLml0ZXJhdG9yXTtcbiAgICAgICAgICAgIGlmICggKHR5cGVvZiBpdGVyYXRvcl9mbiAhPT0gJ3VuZGVmaW5lZCcgJiYgdHlwZW9mIGl0ZXJhdG9yX2ZuICE9PSAnZnVuY3Rpb24nKSAmJlxuICAgICAgICAgICAgICAgICAhKGl0ZXIgaW5zdGFuY2VvZiBHZW5lcmF0b3IpICkge1xuICAgICAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcignZXF1YXRpb25fZGVmLml0ZXIgbXVzdCBiZSBhbiBpdGVyYWJsZSBvciBhIGdlbmVyYXRvciBmdW5jdGlvbicpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIGlmICh0eXBlb2YgaXRlcl9kZWxheSAhPT0gJ3VuZGVmaW5lZCcgJiYgKHR5cGVvZiBpdGVyX2RlbGF5ICE9PSAnbnVtYmVyJyB8fCBpdGVyX2RlbGF5IDwgMCkpIHtcbiAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcignZXF1YXRpb25fZGVmLml0ZXJfZGVsYXkgbXVzdCBiZSBhIG5vbi1uZWdhdGl2ZSBudW1iZXInKTtcbiAgICAgICAgfVxuICAgICAgICBpZiAodHlwZW9mIGYgPT09ICd1bmRlZmluZWQnKSB7XG4gICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoJ2VxdWF0aW9uX2RlZi5mIG11c3QgYmUgZGVmaW5lZCcpO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgdmFsaWRhdGVfZihmKTtcbiAgICAgICAgfVxuICAgIH1cblxuICAgIGxldCBydW5uZXI7XG4gICAgY29uc3Qgc2V0X3J1bm5pbmdfc3RhdGUgPSAocnVubmluZykgPT4ge1xuICAgICAgICBydW5uZXI/LnN0b3AoKTtcbiAgICAgICAgaWYgKHJ1bm5pbmcpIHtcbiAgICAgICAgICAgIGNvbnN0IG5ld19ydW5uZXIgPSBuZXcgUnVubmVyKHRoZV9lcXVhdGlvbl9kZWYpO1xuICAgICAgICAgICAgcnVubmVyID0gbmV3X3J1bm5lcjtcbiAgICAgICAgICAgIG5ld19ydW5uZXIuZG9uZS50aGVuKFxuICAgICAgICAgICAgICAgICgpID0+IHtcbiAgICAgICAgICAgICAgICAgICAgaWYgKCFuZXdfcnVubmVyLnN0b3BwZWQpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHNldF9ydW5uaW5nX3N0YXRlKGZhbHNlKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgZXJyb3IgPT4ge1xuICAgICAgICAgICAgICAgICAgICBpZiAoIW5ld19ydW5uZXIuc3RvcHBlZCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgc2V0X3J1bm5pbmdfc3RhdGUoZmFsc2UpO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgKTtcbiAgICAgICAgICAgIHBvaW50X2NvdW50X2Rpc3BsYXlfZWwuaW5uZXJUZXh0ID0gJyc7XG4gICAgICAgICAgICBnb19idXR0b24uaW5uZXJUZXh0ID0gJ1N0b3AnO1xuICAgICAgICAgICAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ29kZV9wbG90dGVyX3BsYXlfY29udHJvbHMnKS5zY3JvbGxJbnRvVmlldygpO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgcnVubmVyID0gdW5kZWZpbmVkO1xuICAgICAgICAgICAgZ29fYnV0dG9uLmlubmVyVGV4dCA9ICdHbyc7XG4gICAgICAgIH1cbiAgICB9XG4gICAgZ29fYnV0dG9uLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgYXN5bmMgKGV2ZW50KSA9PiB7XG4gICAgICAgIHNldF9ydW5uaW5nX3N0YXRlKCFydW5uZXIpO1xuICAgIH0pO1xuXG4gICAgY2xhc3MgUnVubmVyIHtcbiAgICAgICAgY29uc3RydWN0b3IoZXF1YXRpb25fZGVmKSB7XG4gICAgICAgICAgICB2YWxpZGF0ZV9lcXVhdGlvbl9kZWYoZXF1YXRpb25fZGVmKTtcblxuICAgICAgICAgICAgdGhpcy5fZXF1YXRpb25fZGVmID0gZXF1YXRpb25fZGVmO1xuXG4gICAgICAgICAgICB0aGlzLl94cyA9IFtdO1xuICAgICAgICAgICAgdGhpcy5feXMgPSBbXTtcbiAgICAgICAgICAgIHRoaXMuX3pzID0gW107XG4gICAgICAgICAgICB0aGlzLl9jcyA9IFtdO1xuXG4gICAgICAgICAgICB0aGlzLl9nZGF0YSA9IFt7XG4gICAgICAgICAgICAgICAgbmFtZTogJ2VxdWF0aW9uJyxcbiAgICAgICAgICAgICAgICB0eXBlOiAnc2NhdHRlcjNkJyxcbiAgICAgICAgICAgICAgICBtb2RlOiAnbGluZXMnLFxuICAgICAgICAgICAgICAgIHg6IHRoaXMuX3hzLFxuICAgICAgICAgICAgICAgIHk6IHRoaXMuX3lzLFxuICAgICAgICAgICAgICAgIHo6IHRoaXMuX3pzLFxuICAgICAgICAgICAgICAgIG9wYWNpdHk6IDEsXG4gICAgICAgICAgICAgICAgbGluZToge1xuICAgICAgICAgICAgICAgICAgICB3aWR0aDogMyxcbiAgICAgICAgICAgICAgICAgICAgY29sb3I6IHRoaXMuX2NzLFxuICAgICAgICAgICAgICAgICAgICByZXZlcnNlc2NhbGU6IGZhbHNlLFxuICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICB9XTtcblxuICAgICAgICAgICAgZGlzcGxheV9jb25maWcoKTtcbiAgICAgICAgICAgIHNldF9wb2ludF9jbG91ZF9sb29wX2Rpc3BsYXkoZmFsc2UpO1xuXG4gICAgICAgICAgICB0aGlzLl9tb3VzZV9wYXVzZWQgPSBmYWxzZTtcbiAgICAgICAgICAgIHRoaXMuX3RoZV9wbG90X2VsX21vdXNlZG93bl9oYW5kbGVyID0gKGV2ZW50KSA9PiB7IHRoaXMuX21vdXNlX3BhdXNlZCA9IHRydWU7IH07XG4gICAgICAgICAgICB0aGlzLl90aGVfcGxvdF9lbF9tb3VzZWRvd25faGFuZGxlcl9vcHRpb25zID0geyBjYXB0dXJlOiB0cnVlIH07XG4gICAgICAgICAgICB0aGlzLl90aGVfcGxvdF9lbF9tb3VzZXVwX2hhbmRsZXIgPSAoZXZlbnQpID0+IHsgdGhpcy5fbW91c2VfcGF1c2VkID0gZmFsc2U7IH07XG4gICAgICAgICAgICB0aGlzLl90aGVfcGxvdF9lbF9tb3VzZXVwX2hhbmRsZXJfb3B0aW9ucyA9IHsgY2FwdHVyZTogdHJ1ZSB9O1xuICAgICAgICAgICAgcGxvdF9lbC5hZGRFdmVudExpc3RlbmVyKFxuICAgICAgICAgICAgICAgICdtb3VzZWRvd24nLFxuICAgICAgICAgICAgICAgIHRoaXMuX3RoZV9wbG90X2VsX21vdXNlZG93bl9oYW5kbGVyLFxuICAgICAgICAgICAgICAgIHRoaXMuX3RoZV9wbG90X2VsX21vdXNlZG93bl9oYW5kbGVyX29wdGlvbnNcbiAgICAgICAgICAgICk7XG4gICAgICAgICAgICBwbG90X2VsLmFkZEV2ZW50TGlzdGVuZXIoXG4gICAgICAgICAgICAgICAgJ21vdXNldXAnLFxuICAgICAgICAgICAgICAgIHRoaXMuX3RoZV9wbG90X2VsX21vdXNldXBfaGFuZGxlcixcbiAgICAgICAgICAgICAgICB0aGlzLl90aGVfcGxvdF9lbF9tb3VzZXVwX2hhbmRsZXJfb3B0aW9uc1xuICAgICAgICAgICAgKTtcblxuICAgICAgICAgICAgdGhpcy5fYnV0dG9uX3BhdXNlZCA9IGZhbHNlO1xuICAgICAgICAgICAgdGhpcy5fdGhlX3BhdXNlX2J1dHRvbl9jbGlja19oYW5kbGVyID0gKGV2ZW50KSA9PiB7XG4gICAgICAgICAgICAgICAgdGhpcy5fYnV0dG9uX3BhdXNlZCA9ICF0aGlzLl9idXR0b25fcGF1c2VkO1xuICAgICAgICAgICAgICAgIHNldF9wYXVzZV9idXR0b25fc3RhdGUodGhpcy5fYnV0dG9uX3BhdXNlZCwgdGhpcy5fcnVubmluZyk7XG4gICAgICAgICAgICB9O1xuICAgICAgICAgICAgdGhpcy5fdGhlX3BhdXNlX2J1dHRvbl9jbGlja19oYW5kbGVyX29wdGlvbnMgPSB7fTtcbiAgICAgICAgICAgIHBhdXNlX2J1dHRvbi5hZGRFdmVudExpc3RlbmVyKFxuICAgICAgICAgICAgICAgICdjbGljaycsXG4gICAgICAgICAgICAgICAgdGhpcy5fdGhlX3BhdXNlX2J1dHRvbl9jbGlja19oYW5kbGVyLFxuICAgICAgICAgICAgICAgIHRoaXMuX3RoZV9wYXVzZV9idXR0b25fY2xpY2tfaGFuZGxlcl9vcHRpb25zXG4gICAgICAgICAgICApO1xuXG4gICAgICAgICAgICB0aGlzLl9zdG9wcGVkID0gZmFsc2U7XG4gICAgICAgICAgICB0aGlzLl9ydW5uaW5nID0gZmFsc2U7XG5cbiAgICAgICAgICAgIHRoaXMuX2RvbmUgPSBuZXcgUHJvbWlzZShhc3luYyAocmVzb2x2ZSwgcmVqZWN0KSA9PiB7XG4gICAgICAgICAgICAgICAgdGhpcy5fcnVubmluZyA9IHRydWU7XG4gICAgICAgICAgICAgICAgc2V0X2dvX2J1dHRvbl9zdGF0ZSh0aGlzLl9ydW5uaW5nKTtcbiAgICAgICAgICAgICAgICBzZXRfcGF1c2VfYnV0dG9uX3N0YXRlKHRoaXMuX2J1dHRvbl9wYXVzZWQsIHRoaXMuX3J1bm5pbmcpO1xuXG4gICAgICAgICAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgeyB0aXRsZSwgZiwgaXRlcl9kZWxheSB9ID0gdGhpcy5fZXF1YXRpb25fZGVmO1xuXG4gICAgICAgICAgICAgICAgICAgIGxldCB7IGl0ZXIgfSA9IHRoaXMuX2VxdWF0aW9uX2RlZjtcbiAgICAgICAgICAgICAgICAgICAgaWYgKCFpdGVyKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBpdGVyID0gW3t9XTsgIC8vIG9uZSBlbXB0eSBjb25maWdcbiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIGlmIChpdGVyIGluc3RhbmNlb2YgR2VuZXJhdG9yKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBpdGVyID0gaXRlcih0aGlzLl9lcXVhdGlvbl9kZWYpO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIC8vIGl0ZXIgaXMgbm93IGFuIGl0ZXJhYmxlXG5cbiAgICAgICAgICAgICAgICAgICAgbGV0IGZpcnN0X2l0ZXJhdGlvbiA9IHRydWU7XG4gICAgICAgICAgICAgICAgICAgIGZvciAoY29uc3QgY29uZmlnIG9mIGl0ZXIpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmICghdGhpcy5fcnVubmluZykge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLl9jbGVhcl9kYXRhKCk7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IG1lcmdlZF9jb25maWcgPSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLi4udGhpcy5fZXF1YXRpb25fZGVmLCAgLy8gdGhpcy5fZXF1YXRpb25fZGVmIG1heSBjb250YWluIGNvbmZpZyBwcm9wZXJ0aWVzXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLi4uY29uZmlnLCAgICAgICAgICAgICAgLy8gY29uZmlnIHByb3BlcnRpZXMgb3ZlcnJpZGUgdGhvc2UgaW4gdGhpcy5fZXF1YXRpb25fZGVmXG4gICAgICAgICAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgICAgICAgICAgICAgdmFsaWRhdGVfY29uZmlnKG1lcmdlZF9jb25maWcpO1xuXG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoaXRlcl9kZWxheSAmJiAhZmlyc3RfaXRlcmF0aW9uKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYXdhaXQgbmV3IFByb21pc2UocmVzb2x2ZSA9PiBzZXRUaW1lb3V0KHJlc29sdmUsIGl0ZXJfZGVsYXkpKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIGZpcnN0X2l0ZXJhdGlvbiA9IGZhbHNlO1xuXG4gICAgICAgICAgICAgICAgICAgICAgICBjb25zdCB7IGludGVncmF0b3IsIGR0LCB4MCwgcGFyYW1zLCBza2lwPTAsIHN0ZXBzPUluZmluaXR5LCBwb2ludF9jbG91ZCB9ID0gbWVyZ2VkX2NvbmZpZztcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmICh0eXBlb2YgaW50ZWdyYXRvciA9PT0gJ3VuZGVmaW5lZCcpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoJ2ludGVncmF0b3Igd2FzIG5vdCBzcGVjaWZpZWQnKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIGlmICh0eXBlb2YgZHQgPT09ICd1bmRlZmluZWQnKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKCdkdCB3YXMgbm90IHNwZWNpZmllZCcpO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHR5cGVvZiB4MCA9PT0gJ3VuZGVmaW5lZCcpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoJ3gwIHdhcyBub3Qgc3BlY2lmaWVkJyk7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICAgICAgICAgIGRpc3BsYXlfY29uZmlnKG1lcmdlZF9jb25maWcpO1xuXG4gICAgICAgICAgICAgICAgICAgICAgICBsZXQgeCA9IFsgLi4ueDAgXTsgIC8vIGNvcHkgeDAgdG8gaW5zdWxhdGUgZnJvbSBtdXRhdGlvblxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHNraXAgPD0gMCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuX2FkZCh4KTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgICAgICAgICAgbGV0IHBsb3RfZm4gPSBQbG90bHkubmV3UGxvdDtcbiAgICAgICAgICAgICAgICAgICAgICAgIGxldCBwb2ludF9jb3VudCA9IDA7XG4gICAgICAgICAgICAgICAgICAgICAgICB3aGlsZSAodGhpcy5fcnVubmluZyAmJiBwb2ludF9jb3VudCA8IHNraXArc3RlcHMpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoIXRoaXMucGF1c2VkKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IHBvaW50c19wZXJfbG9vcCA9IHBhcnNlSW50KHBvaW50c19wZXJfbG9vcF9lbC52YWx1ZSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZvciAobGV0IGxwID0gMDsgbHAgPCBwb2ludHNfcGVyX2xvb3A7IGxwKyspIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmICghdGhpcy5fcnVubmluZykge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgeCA9IGludGVncmF0b3IoZHQsIGYsIHgsIHBhcmFtcyk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBwb2ludF9jb3VudCsrO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHBvaW50X2NvdW50ID49IHNraXApIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLl9hZGQoeCk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAocG9pbnRfY291bnQgPj0gc2tpcCtzdGVwcykge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5fdHJpbV9kYXRhKCk7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHBvaW50X2NvdW50ID49IHNraXApIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuX2RyYXdfZGF0YShwbG90X2ZuKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHBsb3RfZm4gPSBQbG90bHkucmVhY3Q7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBwb2ludF9jb3VudF9kaXNwbGF5X2VsLmlubmVyVGV4dCA9IHBvaW50X2NvdW50O1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChwb2ludF9jb3VudCA8IHNraXArc3RlcHMpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgbG9vcF9kZWxheSA9IHBhcnNlSW50KGxvb3BfZGVsYXlfZWwudmFsdWUpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBhd2FpdCBuZXcgUHJvbWlzZShyZXNvbHZlID0+IHNldFRpbWVvdXQocmVzb2x2ZSwgbG9vcF9kZWxheSkpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgICAgICAgICAgLy8gRG9uZSBwbG90dGluZyBncmFwaCBmb3IgdGhpcyBjb25maWcuXG4gICAgICAgICAgICAgICAgICAgICAgICAvLyBGaW5hbGx5LCBydW4gaXRzIHBvaW50IGNsb3VkLCBpZiBhbnkuXG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAodGhpcy5fcnVubmluZyAmJiBwb2ludF9jbG91ZCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGF3YWl0IHRoaXMuX3J1bl9wb2ludF9jbG91ZChmLCBtZXJnZWRfY29uZmlnKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgICAgIC8vIGRvbmVcbiAgICAgICAgICAgICAgICAgICAgcmVzb2x2ZSgpO1xuXG4gICAgICAgICAgICAgICAgfSBjYXRjaCAoZXJyKSB7XG4gICAgICAgICAgICAgICAgICAgIGNvbnNvbGUuZXJyb3IoZXJyLm1lc3NhZ2UsIGVyci5zdGFjayk7XG4gICAgICAgICAgICAgICAgICAgIGFsZXJ0KGAke2Vyci5tZXNzYWdlfVxcblxcbiR7ZXJyLnN0YWNrfWApO1xuICAgICAgICAgICAgICAgICAgICByZWplY3QoZXJyKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfVxuXG4gICAgICAgIGdldCBydW5uaW5nICgpeyByZXR1cm4gdGhpcy5fcnVubmluZzsgfVxuICAgICAgICBnZXQgcGF1c2VkICAoKXsgcmV0dXJuIHRoaXMuX21vdXNlX3BhdXNlZCB8fCB0aGlzLl9idXR0b25fcGF1c2VkOyB9XG4gICAgICAgIGdldCBzdG9wcGVkICgpeyByZXR1cm4gdGhpcy5fc3RvcHBlZDsgfVxuICAgICAgICBnZXQgZG9uZSAgICAoKXsgcmV0dXJuIHRoaXMuX2RvbmU7IH1cblxuICAgICAgICBzdG9wKCkge1xuICAgICAgICAgICAgdGhpcy5fc3RvcHBlZCA9IHRydWU7XG4gICAgICAgICAgICB0aGlzLl9ydW5uaW5nID0gZmFsc2U7XG4gICAgICAgICAgICBwbG90X2VsLnJlbW92ZUV2ZW50TGlzdGVuZXIoXG4gICAgICAgICAgICAgICAgJ21vdXNlZG93bicsXG4gICAgICAgICAgICAgICAgdGhpcy5fdGhlX3Bsb3RfZWxfbW91c2Vkb3duX2hhbmRsZXIsXG4gICAgICAgICAgICAgICAgdGhpcy5fdGhlX3Bsb3RfZWxfbW91c2Vkb3duX2hhbmRsZXJfb3B0aW9uc1xuICAgICAgICAgICAgKTtcbiAgICAgICAgICAgIHBsb3RfZWwucmVtb3ZlRXZlbnRMaXN0ZW5lcihcbiAgICAgICAgICAgICAgICAnbW91c2V1cCcsXG4gICAgICAgICAgICAgICAgdGhpcy5fdGhlX3Bsb3RfZWxfbW91c2V1cF9oYW5kbGVyLFxuICAgICAgICAgICAgICAgIHRoaXMuX3RoZV9wbG90X2VsX21vdXNldXBfaGFuZGxlcl9vcHRpb25zXG4gICAgICAgICAgICApO1xuICAgICAgICAgICAgcGF1c2VfYnV0dG9uLnJlbW92ZUV2ZW50TGlzdGVuZXIoXG4gICAgICAgICAgICAgICAgJ2NsaWNrJyxcbiAgICAgICAgICAgICAgICB0aGlzLl90aGVfcGF1c2VfYnV0dG9uX2NsaWNrX2hhbmRsZXIsXG4gICAgICAgICAgICAgICAgdGhpcy5fdGhlX3BhdXNlX2J1dHRvbl9jbGlja19oYW5kbGVyX29wdGlvbnNcbiAgICAgICAgICAgICk7XG4gICAgICAgICAgICB0aGlzLl9idXR0b25fcGF1c2VkID0gZmFsc2U7XG4gICAgICAgICAgICBzZXRfcGF1c2VfYnV0dG9uX3N0YXRlKHRoaXMuX2J1dHRvbl9wYXVzZWQsIHRoaXMuX3J1bm5pbmcpO1xuICAgICAgICB9XG5cbiAgICAgICAgLy8gaW50ZXJuYWxcblxuICAgICAgICBfY2xlYXJfZGF0YSgpIHtcbiAgICAgICAgICAgIHRoaXMuX3hzLnNwbGljZSgwLCB0aGlzLl94cy5sZW5ndGgpO1xuICAgICAgICAgICAgdGhpcy5feXMuc3BsaWNlKDAsIHRoaXMuX3lzLmxlbmd0aCk7XG4gICAgICAgICAgICB0aGlzLl96cy5zcGxpY2UoMCwgdGhpcy5fenMubGVuZ3RoKTtcbiAgICAgICAgICAgIHRoaXMuX2NzLnNwbGljZSgwLCB0aGlzLl9jcy5sZW5ndGgpO1xuICAgICAgICB9XG5cbiAgICAgICAgX3RyaW1fZGF0YSgpIHtcbiAgICAgICAgICAgIGxldCBsaW1pdCA9IHBhcnNlSW50KHBvaW50c19zaG93bl9lbC52YWx1ZSk7XG4gICAgICAgICAgICBpZiAoaXNOYU4obGltaXQpKSB7XG4gICAgICAgICAgICAgICAgbGltaXQgPSAwO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYgKHRoaXMuX3hzLmxlbmd0aCA+IGxpbWl0KSB7XG4gICAgICAgICAgICAgICAgdGhpcy5feHMuc3BsaWNlKDAsIHRoaXMuX3hzLmxlbmd0aC1saW1pdCk7XG4gICAgICAgICAgICAgICAgdGhpcy5feXMuc3BsaWNlKDAsIHRoaXMuX3lzLmxlbmd0aC1saW1pdCk7XG4gICAgICAgICAgICAgICAgdGhpcy5fenMuc3BsaWNlKDAsIHRoaXMuX3pzLmxlbmd0aC1saW1pdCk7XG4gICAgICAgICAgICAgICAgdGhpcy5fY3Muc3BsaWNlKDAsIHRoaXMuX2NzLmxlbmd0aC1saW1pdCk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cblxuICAgICAgICBfYWRkKFt4LCB5LCB6XSwgYz0xKSB7XG4gICAgICAgICAgICB0aGlzLl94cy5wdXNoKHggPz8gMCk7XG4gICAgICAgICAgICB0aGlzLl95cy5wdXNoKHkgPz8gMCk7XG4gICAgICAgICAgICB0aGlzLl96cy5wdXNoKHogPz8gMCk7XG4gICAgICAgICAgICB0aGlzLl9jcy5wdXNoKGMpO1xuICAgICAgICB9XG5cbiAgICAgICAgX2RyYXdfZGF0YShwbG90X2ZuKSB7XG4gICAgICAgICAgICBjb25zdCBsYXlvdXQgPSB7XG4gICAgICAgICAgICAgICAgaGVpZ2h0OiBwbG90X2hlaWdodCxcbiAgICAgICAgICAgICAgICBkYXRhcmV2aXNpb246IERhdGUubm93KCksXG4gICAgICAgICAgICB9O1xuICAgICAgICAgICAgLy8gbm90ZTogcGxvdF9lbC5fZnVsbExheW91dCBpcyB1bmRvY3VtZW50ZWQuLi5cbiAgICAgICAgICAgIGlmIChwbG90X2VsLl9mdWxsTGF5b3V0Py5zY2VuZT8uY2FtZXJhKSB7XG4gICAgICAgICAgICAgICAgbGF5b3V0LnNjZW5lID0ge1xuICAgICAgICAgICAgICAgICAgICBjYW1lcmE6IHBsb3RfZWwuX2Z1bGxMYXlvdXQuc2NlbmUuY2FtZXJhLFxuICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpZiAodGhpcy5fZXF1YXRpb25fZGVmPy50aXRsZSkge1xuICAgICAgICAgICAgICAgIGxheW91dC50aXRsZSA9IHRoaXMuX2VxdWF0aW9uX2RlZi50aXRsZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHBsb3RfZm4ocGxvdF9lbCwgdGhpcy5fZ2RhdGEsIGxheW91dCk7XG4gICAgICAgIH1cblxuICAgICAgICBhc3luYyBfcnVuX3BvaW50X2Nsb3VkKGYsIGNvbmZpZykge1xuICAgICAgICAgICAgY29uc3QgeyBpbnRlZ3JhdG9yLCBkdCwgeDAsIHBhcmFtcywgcG9pbnRfY2xvdWQgfSA9IGNvbmZpZztcbiAgICAgICAgICAgIGNvbnN0IHsgbiwgYywgciwgZHQ6cGNfZHQ9ZHQsIHN0ZXBzPUluZmluaXR5IH0gPSBwb2ludF9jbG91ZDtcblxuICAgICAgICAgICAgY29uc3QgQXJyYXlUeXBlID0gRmxvYXQ2NEFycmF5O1xuXG4gICAgICAgICAgICBzZXRfcG9pbnRfY2xvdWRfbG9vcF9kaXNwbGF5KHRydWUsICcnKTtcblxuICAgICAgICAgICAgLy8gY29uZmlnIGNvbnRhaW5zIHBvaW50X2Nsb3VkXG4gICAgICAgICAgICAvLyBhc3N1bWUgY29uZmlnIGhhcyBhbHJlYWR5IGJlZW4gdmFsaWRhdGVkXG4gICAgICAgICAgICBpZiAoIXRoaXMuX2dkYXRhKSB7XG4gICAgICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKCd1bmV4cGVjdGVkOiAhdGhpcy5fZ2RhdGEnKTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgLy8gc2V0IHVwIHdvcmtlcnNcbiAgICAgICAgICAgIGNvbnN0IHdvcmtlcl9jb3VudCA9IHdvcmtlcl9wb29sLndvcmtlcnMubGVuZ3RoO1xuICAgICAgICAgICAgY29uc3QgcG9pbnRzX3Blcl93b3JrZXIgPSBNYXRoLmZsb29yKG4gLyB3b3JrZXJfY291bnQpO1xuICAgICAgICAgICAgY29uc3Qgd29ya2VyX2Rlc2NzID0gWyAuLi53b3JrZXJfcG9vbC53b3JrZXJzIF0ubWFwKCh3b3JrZXIsIGluZGV4KSA9PiB7XG4gICAgICAgICAgICAgICAgY29uc3Qgc3RhcnQgPSBpbmRleCpwb2ludHNfcGVyX3dvcmtlcjtcbiAgICAgICAgICAgICAgICBjb25zdCBlbmQgICA9IChpbmRleCA+PSB3b3JrZXJfY291bnQtMSkgPyBuIDogKHN0YXJ0ICsgcG9pbnRzX3Blcl93b3JrZXIpO1xuXG4gICAgICAgICAgICAgICAgY29uc3QgcG9pbnRfY291bnQgPSAoZW5kIC0gc3RhcnQpO1xuXG4gICAgICAgICAgICAgICAgY29uc3QgcGNfdHJhY2UgPSB7XG4gICAgICAgICAgICAgICAgICAgIG5hbWU6ICdwb2ludCBjbG91ZCcsXG4gICAgICAgICAgICAgICAgICAgIHR5cGU6ICdzY2F0dGVyM2QnLFxuICAgICAgICAgICAgICAgICAgICBtb2RlOiAnbWFya2VycycsXG4gICAgICAgICAgICAgICAgICAgIG1hcmtlcjoge1xuICAgICAgICAgICAgICAgICAgICAgICAgY29sb3I6ICdyZ2JhKDAsIDAsIDI1NSwgMS4wKScsXG4gICAgICAgICAgICAgICAgICAgICAgICBzaXplOiAxLFxuICAgICAgICAgICAgICAgICAgICB9LFxuXG4gICAgICAgICAgICAgICAgICAgIHg6IG5ldyBBcnJheVR5cGUocG9pbnRfY291bnQpLFxuICAgICAgICAgICAgICAgICAgICB5OiBuZXcgQXJyYXlUeXBlKHBvaW50X2NvdW50KSxcbiAgICAgICAgICAgICAgICAgICAgejogbmV3IEFycmF5VHlwZShwb2ludF9jb3VudCksXG4gICAgICAgICAgICAgICAgfTtcblxuICAgICAgICAgICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICAgICAgICAgIHdvcmtlcixcbiAgICAgICAgICAgICAgICAgICAgaW5kZXgsXG4gICAgICAgICAgICAgICAgICAgIHBvaW50X2NvdW50LFxuICAgICAgICAgICAgICAgICAgICBwY190cmFjZSxcbiAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAvLyBpbml0aWFsaXplIHdvcmtlciBzdGF0ZSwgZXRjXG4gICAgICAgICAgICBmb3IgKGNvbnN0IHdvcmtlcl9kZXNjIG9mIHdvcmtlcl9kZXNjcykge1xuICAgICAgICAgICAgICAgIGNvbnN0IHdvcmtlciA9IHdvcmtlcl9kZXNjLndvcmtlcjtcbiAgICAgICAgICAgICAgICAvLyBpbml0aWFsaXplIHBjX3RyYWNlIHgsIHksIHogYXJyYXlzIHdpdGggdGhlIGluaXRpYWwgdmFsdWVzXG4gICAgICAgICAgICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCB3b3JrZXJfZGVzYy5wb2ludF9jb3VudDsgaSsrKSB7XG4gICAgICAgICAgICAgICAgICAgIC8vIGdlbmVyYXRlIHRoZSBpbml0aWFsIHBvc2l0aW9ucyBvZiB0aGUgcG9pbnRzXG4gICAgICAgICAgICAgICAgICAgIC8vIHRoZSBwb2ludHMgd2UgZ2VuZXJhdGUgaGVyZSBsaWUgaW4gYSBOLWN1YmUgY2VudGVyZWQgYXQgY1xuICAgICAgICAgICAgICAgICAgICAvLyB3aXRoIHNpZGUgbGVuZ3RoIDIqciAod2hlcmUgTiA9IGMubGVuZ3RoKS5cbiAgICAgICAgICAgICAgICAgICAgY29uc3QgWyB4LCB5LCB6IF0gPSBjLm1hcCh4aSA9PiB4aSArIHIqMiooTWF0aC5yYW5kb20oKSAtIDAuNSkpO1xuICAgICAgICAgICAgICAgICAgICB3b3JrZXJfZGVzYy5wY190cmFjZS54W2ldID0geDtcbiAgICAgICAgICAgICAgICAgICAgd29ya2VyX2Rlc2MucGNfdHJhY2UueVtpXSA9IHk7XG4gICAgICAgICAgICAgICAgICAgIHdvcmtlcl9kZXNjLnBjX3RyYWNlLnpbaV0gPSB6O1xuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIC8vIGFkZCBuZXcgdHJhY2UgdG8gdGhlIGdyYXBoaWNzIGRhdGFcbiAgICAgICAgICAgICAgICB0aGlzLl9nZGF0YS5wdXNoKHdvcmtlcl9kZXNjLnBjX3RyYWNlKTtcblxuICAgICAgICAgICAgICAgIC8vIHNldCB1cCB3b3JrZXIgc3RhdGVcbiAgICAgICAgICAgICAgICBhd2FpdCB3b3JrZXIuZXZhbChgZ2xvYmFsVGhpcy5pbnRlZ3JhdG9yID0gJHtpbnRlZ3JhdG9yLnRvU3RyaW5nKCl9O2ApO1xuICAgICAgICAgICAgICAgIGF3YWl0IHdvcmtlci5ldmFsKGBnbG9iYWxUaGlzLmYgPSAke2YudG9TdHJpbmcoKX07YCk7XG4gICAgICAgICAgICAgICAgYXdhaXQgd29ya2VyLmV2YWwoXG4gICAgICAgICAgICAgICAgICAgIGBjb25zdCBbIHBjX2R0LCBwYXJhbXMsIHBvaW50X2NvdW50LCB4LCB5LCB6IF0gPSBvYmplY3RzOyBPYmplY3QuYXNzaWduKGdsb2JhbFRoaXMsIHsgcGNfZHQsIHBhcmFtcywgcG9pbnRfY291bnQsIHgsIHksIHogfSk7YCxcbiAgICAgICAgICAgICAgICAgICAgcGNfZHQsIHBhcmFtcywgd29ya2VyX2Rlc2MucG9pbnRfY291bnQsIHdvcmtlcl9kZXNjLnBjX3RyYWNlLngsIHdvcmtlcl9kZXNjLnBjX3RyYWNlLnksIHdvcmtlcl9kZXNjLnBjX3RyYWNlLnpcbiAgICAgICAgICAgICAgICApO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBtYWluX2xvb3A6XG4gICAgICAgICAgICBmb3IgKGxldCBzID0gMDsgcyA8IHN0ZXBzOyBzKyspIHtcbiAgICAgICAgICAgICAgICB3aGlsZSAodGhpcy5wYXVzZWQgJiYgdGhpcy5fcnVubmluZykge1xuICAgICAgICAgICAgICAgICAgICBhd2FpdCBuZXcgUHJvbWlzZShyZXNvbHZlID0+IHNldFRpbWVvdXQocmVzb2x2ZSksIDEwMCk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGlmICghdGhpcy5fcnVubmluZykge1xuICAgICAgICAgICAgICAgICAgICBicmVhayBtYWluX2xvb3A7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGNvbnN0IHBvaW50c19wZXJfbG9vcCA9IDE7Ly8hISFwYXJzZUludChwb2ludHNfcGVyX2xvb3BfZWwudmFsdWUpO1xuICAgICAgICAgICAgICAgIGZvciAobGV0IGxwID0gMDsgbHAgPCBwb2ludHNfcGVyX2xvb3A7IGxwKyspIHtcbiAgICAgICAgICAgICAgICAgICAgaWYgKCF0aGlzLl9ydW5uaW5nKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBicmVhayBtYWluX2xvb3A7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgYXdhaXQgUHJvbWlzZS5hbGwoXG4gICAgICAgICAgICAgICAgICAgICAgICB3b3JrZXJfZGVzY3MubWFwKFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHdvcmtlcl9kZXNjID0+IHdvcmtlcl9kZXNjLndvcmtlci5ldmFsKGBcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCBwb2ludF9jb3VudDsgaSsrKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBsZXQgcHggPSBbIHhbaV0sIHlbaV0sIHpbaV0gXTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHB4ID0gaW50ZWdyYXRvcihwY19kdCwgZiwgcHgsIHBhcmFtcyk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB4W2ldID0gcHhbMF07XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB5W2ldID0gcHhbMV07XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB6W2ldID0gcHhbMl07XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFsgeCwgeSwgeiBdO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGApLnRoZW4oKFsgbmV3X3gsIG5ld195LCBuZXdfeiBdKSA9PiB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHdvcmtlcl9kZXNjLnBjX3RyYWNlLnggPSBuZXdfeDtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgd29ya2VyX2Rlc2MucGNfdHJhY2UueSA9IG5ld195O1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB3b3JrZXJfZGVzYy5wY190cmFjZS56ID0gbmV3X3o7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSlcbiAgICAgICAgICAgICAgICAgICAgICAgIClcbiAgICAgICAgICAgICAgICAgICAgKTtcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICB0aGlzLl9kcmF3X2RhdGEoUGxvdGx5LnJlYWN0KTtcblxuICAgICAgICAgICAgICAgIHNldF9wb2ludF9jbG91ZF9sb29wX2Rpc3BsYXkodHJ1ZSwgcysxKTtcblxuICAgICAgICAgICAgICAgIGNvbnN0IGxvb3BfZGVsYXkgPSBwYXJzZUludChsb29wX2RlbGF5X2VsLnZhbHVlKTtcbiAgICAgICAgICAgICAgICBhd2FpdCBuZXcgUHJvbWlzZShyZXNvbHZlID0+IHNldFRpbWVvdXQocmVzb2x2ZSwgbG9vcF9kZWxheSkpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfVxuXG4gICAgc2V0VGltZW91dCgoKSA9PiB7XG4gICAgICAgIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdvZGVfcGxvdHRlcl9hZGp1c3RtZW50cycpLnNjcm9sbEludG9WaWV3KGZhbHNlKTtcbiAgICAgICAgZ29fYnV0dG9uLmZvY3VzKCk7XG4gICAgfSk7XG59XG52YXJzKHsgc2V0dXAgfSk7Iiwib3V0cHV0IjpbXSwiZm9ybWF0dGluZ19vcHRpb25zIjp7ImFsaWduIjoibGVmdCIsImluZGVudCI6IjBlbSJ9fSx7ImlkIjoiaWQtZmQ5MjA0YTctMzg5YS00MTFmLTg0ZjEtN2FiYTc0N2E4NTA1IiwiaW5wdXQiOiIvLyBhdXRvaGlkZVxuXG4vLyBpbnRlZ3JhdG9yOlxuLy8gZih4KSByZXR1cm5zIHhkb3Qgd2hpY2ggaGFzIHRoZSBzYW1lIGRpbWVuc2lvbiBhcyB4XG4vLyBpbnRlZ3JhdG9yIHJldHVybnMgYSBuZXcgeCB3aXRoIHRoZSBzYW1lIGRpbWVuc2lvbiBhcyB0aGUgb3JpZ2luYWxcblxuZnVuY3Rpb24gcnVuZ2Vfa3V0dGFfaW50ZWdyYXRvcihkdCwgZiwgeCwgcGFyYW1zKSB7XG4gICAgLy8gVGhpcyBpcyBhbiBpbXBsZW1lbnRhdGlvbiBvZiB0aGUgZm91cnRoLW9yZGVyIFJ1bmdlLUt1dHRhIG1ldGhvZFxuICAgIC8vIGFzIHByZXNlbnRlZCBpbiBOb25saW5lYXIgRHluYW1pY3MgYW5kIENoYW9zLCBTZWNvbmQgRWRpdGlvbiwgYnlcbiAgICAvLyBTdGV2ZW4gSC4gU3Ryb2dhdHosIHBhZ2UgMzQuXG4gICAgLy8gVGhpcyBpbXBsZW1lbnRhdGlvbiB3b3JrcyBmb3IgeCB3aXRoIGFyYml0cmFyeSBkaW1lbnNpb24uXG4gICAgY29uc3QgazEgPSBmKCB4LCAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcGFyYW1zICkubWFwKCB4aWRvdCA9PiB4aWRvdCpkdCApO1xuICAgIGNvbnN0IGsyID0gZiggeC5tYXAoICh4aSwgaSkgPT4geGkgKyBrMVtpXS8yICksIHBhcmFtcyApLm1hcCggeGlkb3QgPT4geGlkb3QqZHQgKTtcbiAgICBjb25zdCBrMyA9IGYoIHgubWFwKCAoeGksIGkpID0+IHhpICsgazJbaV0vMiApLCBwYXJhbXMgKS5tYXAoIHhpZG90ID0+IHhpZG90KmR0ICk7XG4gICAgY29uc3QgazQgPSBmKCB4Lm1hcCggKHhpLCBpKSA9PiB4aSArIGszW2ldKSwgICAgcGFyYW1zICkubWFwKCB4aWRvdCA9PiB4aWRvdCpkdCApO1xuICAgIHJldHVybiB4Lm1hcCggKHhpLCBpKSA9PiB4aSArIChrMVtpXSArIDIqazJbaV0gKyAyKmszW2ldICsgazRbaV0pLzYgKTtcbn1cblxudmFycyh7IHJ1bmdlX2t1dHRhX2ludGVncmF0b3IgfSk7Iiwib3V0cHV0IjpbXSwiZm9ybWF0dGluZ19vcHRpb25zIjp7ImFsaWduIjoibGVmdCIsImluZGVudCI6IjBlbSJ9fSx7ImlkIjoiaWQtNDM1OTBkNDItYzExYi00YzYwLWI2MzEtMmFjNjZiZjA0ZDBkIiwiaW5wdXQiOiIvL1xuY29uc3QgZ28gPSBzZXR1cC5iaW5kKHRoaXMsIG91dHB1dF9jb250ZXh0KTtcblxuLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vXG4vL1xuLy8gRXF1YXRpb25EZWYgPSBDb25maWcgKyB7XG4vLyAgICAgdGl0bGU/OiBzdHJpbmcsXG4vLyAgICAgZjogRnVuY3Rpb24sXG4vLyAgICAgaXRlcj86IGl0ZXJhYmxlPENvbmZpZz58Z2VuZXJhdG9yPENvbmZpZz4oZGVmOiBFcXVhdGlvbkRlZiksXG4vLyAgICAgaXRlcl9kZWxheT86IG51bWJlcixcbi8vIH1cbi8vXG4vLyBDb25maWcgPSB7XG4vLyAgICAgaW50ZWdyYXRvcj86IChkdDogbnVtYmVyLCBmOiBGdW5jdGlvbiwgeDogbnVtYmVyW10sIHBhcmFtczogYW55KSA9PiBudW1iZXJbXSxcbi8vICAgICBkdD86IG51bWJlcixcbi8vICAgICB4MD86IG51bWJlcltdLFxuLy8gICAgIHBhcmFtcz86IGFueSxcbi8vICAgICBza2lwPzogIGludGVnZXIsXG4vLyAgICAgc3RlcHM/OiBpbnRlZ2VyLFxuLy8gICAgIHBvaW50X2Nsb3VkPzogUG9pbnRDbG91ZCxcbi8vIH1cbi8vXG4vLyBQb2ludENsb3VkID0ge1xuLy8gICAgIG46IGludGVnZXIsXG4vLyAgICAgYzogbnVtYmVyW107XG4vLyAgICAgcjogbnVtYmVyLFxuLy8gICAgIGR0PzogbnVtYmVyLFxuLy8gICAgIHN0ZXBzPzogaW50ZWdlcixcbi8vIH1cbi8vXG4vLyBGdW5jdGlvbiA9ICh4OiBudW1iZXJbXSwgcGFyYW1zPzogYW55KSA9PiBudW1iZXJbXVxuLy9cbi8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vL1xuXG5cbi8vIERlZmluaXRpb25zIGZvciBzb21lIGNoYW90aWMgYXR0cmFjdG9ycyBwcm92aWRlZCBieSBEci4gSmFtZXMgUC4gQ3J1dGNoZmllbGRcbi8vIChvbmUgb2YgdGhlIHBpb25lZXJzIG9mIENoYW9zIFRoZW9yeSkuXG4vL1xuLy8gRm9yIG1vcmUgaW5mb3JtYXRpb24gb24gY2hhb3RpYyBhdHRyYWN0b3JzIHNlZSBMZWN0dXJlIDMgb24gdGhlIFJvYWRtYXAgcGFnZSBhdCB0aGUgY291cnNlOlxuLy9cbi8vICAgICAgICAgICAgICAgICBodHRwOi8vY3NjLnVjZGF2aXMuZWR1L35jaGFvcy9jb3Vyc2VzL3BvY2kvXG5cbmNvbnN0IGludGVncmF0b3IgPSBydW5nZV9rdXR0YV9pbnRlZ3JhdG9yO1xuXG5jb25zdCBsb3JlbnpfZGVmID0ge1xuICAgIHRpdGxlOiAnTG9yZW56IEF0dHJhY3RvcicsXG4gICAgaW50ZWdyYXRvcixcbiAgICBkdDogMC4wMDUsXG4gICAgeDA6IFszLCAzLCAxXSxcbiAgICBmOiAgKCAoc2lnbWE9MTAsIHI9MjgsIGI9OC8zKSA9PlxuICAgICAgICAgIChbeCwgeSwgel0pID0+IFsgIC8vIHRoaXMgaXMgZiwgYW5kIGl0IHRha2VzIDEgYXJndW1lbnQgd2hpY2ggaXMgZGVjb21wb3NlZCBpbnRvIFt4LCB5LCB6XVxuICAgICAgICAgICAgICBzaWdtYSooeSAtIHgpLFxuICAgICAgICAgICAgICByKnggLSB5IC0geCp6LFxuICAgICAgICAgICAgICB4KnkgLSBiKnosXG4gICAgICAgICAgXVxuICAgICAgICApKClcbn07XG5cbmNvbnN0IG93bF9kZWYgPSB7XG4gICAgdGl0bGU6ICdPd2wgQXR0cmFjdG9yJyxcbiAgICBpbnRlZ3JhdG9yLFxuICAgIGR0OiAwLjAwNSxcbiAgICB4MDogWzMsIDMsIDFdLFxuICAgIGY6ICAoIChhPTEwLCBiPTEwLCBjPTEzKSA9PlxuICAgICAgICAgIChbeCwgeSwgel0pID0+IFtcbiAgICAgICAgICAgICAgLWEqKHggKyB5KSxcbiAgICAgICAgICAgICAgLXkgLSBiKngqeixcbiAgICAgICAgICAgICAgMTAqeCp5ICsgYyxcbiAgICAgICAgICBdXG4gICAgICAgICkoKVxufTtcblxuY29uc3Qgcm9zc2xlcl9kZWYgPSB7XG4gICAgdGl0bGU6ICdS9nNzbGVyIEF0dHJhY3RvcicsXG4gICAgaW50ZWdyYXRvcixcbiAgICBkdDogMC4wMDgsXG4gICAgeDA6IFsxMCwgMTAsIDFdLFxuICAgIGY6ICAoIChhPTAuMiwgYj0wLjIsIGM9NS43KSA9PlxuICAgICAgICAgKFt4LCB5LCB6XSkgPT4gW1xuICAgICAgICAgICAgIC15IC0geixcbiAgICAgICAgICAgICB4ICsgYSp5LFxuICAgICAgICAgICAgIGIgKyB6Kih4IC0gYyksXG4gICAgICAgICBdXG4gICAgICAgICkoKVxufTtcblxuY29uc3QgcmlraXRha2UwX2RlZiA9IHsgIC8vIHNlZTogaHR0cHM6Ly93d3cubmNiaS5ubG0ubmloLmdvdi9wbWMvYXJ0aWNsZXMvUE1DNzUxNzIxMC9cbiAgICB0aXRsZTogJ1Jpa2l0YWtlIEF0dHJhY3RvciAoIGZyb20gaHR0cHM6Ly93d3cubmNiaS5ubG0ubmloLmdvdi9wbWMvYXJ0aWNsZXMvUE1DNzUxNzIxMC8gKScsXG4gICAgaW50ZWdyYXRvcixcbiAgICBkdDogMC4wMSxcbiAgICB4MDogWzMsIDEsIDZdLFxuICAgIGY6ICAoIChhbHBoYT01LCBiZXRhPTIpID0+XG4gICAgICAgICAgKFt4LCB5LCB6XSkgPT4gW1xuICAgICAgICAgICAgICAtYmV0YSp4ICsgeSp6LFxuICAgICAgICAgICAgICAtYmV0YSp5IC0gYWxwaGEqeCArIHgqeixcbiAgICAgICAgICAgICAgMSAtIHgqeSxcbiAgICAgICAgICBdXG4gICAgICAgICkoKVxufTtcblxuY29uc3QgcmlraXRha2VfZGVmID0ge1xuICAgIHRpdGxlOiAnUmlraXRha2UgQXR0cmFjdG9yJyxcbiAgICBpbnRlZ3JhdG9yLFxuICAgIGR0OiAwLjAwOSxcbiAgICB4MDogWzAuMjY4LCAyLCAwXSxcbiAgICBmOiAgKCAoYT0xLCBiPTMuNzUpID0+XG4gICAgICAgICAgKFt4LCB5LCB6XSkgPT4gW1xuICAgICAgICAgICAgICAtYSp4ICsgeip5LFxuICAgICAgICAgICAgICAtYSp5IC0gKHogLSBiKSp4LFxuICAgICAgICAgICAgICAxIC0geCp5LFxuICAgICAgICAgIF1cbiAgICAgICAgKSgpXG59O1xuXG5jb25zdCBoeXBlcmNoYW9zX2RlZiA9IHtcbiAgICB0aXRsZTogJ0h5cGVyY2hhb3MgQXR0cmFjdG9yJyxcbiAgICBpbnRlZ3JhdG9yLFxuICAgIGR0OiAwLjAwNSxcbiAgICB4MDogWy0yMCwgMTUsIDAsIDM1XSxcbiAgICBmOiAgKCAoYT0wLjI1LCBiPS0wLjUsIGM9Mi4yLCBkPTAuMDUpID0+XG4gICAgICAgICAgKFt4LCB5LCB6LCB3XSkgPT4gW1xuICAgICAgICAgICAgICAteSAtIHosXG4gICAgICAgICAgICAgIHggKyBhKnkgKyB3LFxuICAgICAgICAgICAgICBjICsgeCp6LFxuICAgICAgICAgICAgICBiKnogKyBkKncsXG4gICAgICAgICAgXVxuICAgICAgICApKClcbn07XG5cbmNvbnN0IHBvaW50X2Nsb3VkX2RlZiA9IHtcbiAgICB0aXRsZTogJ0xvcmVueiBBdHRyYWN0b3IgV2l0aCBQb2ludCBDbG91ZCcsXG4gICAgaW50ZWdyYXRvcixcbiAgICBkdDogMC4wMDUsXG4gICAgeDA6IFszLCAzLCAxXSxcbiAgICBwYXJhbXM6IHsgc2lnbWE6IDEwLCByOiAyOCwgYjogOC8zIH0sXG4gICAgZjogIChbeCwgeSwgel0sIHtzaWdtYSwgciwgYn0pID0+IFtcbiAgICAgICAgICAgICBzaWdtYSooeSAtIHgpLFxuICAgICAgICAgICAgIHIqeCAtIHkgLSB4KnosXG4gICAgICAgICAgICAgeCp5IC0gYip6LFxuICAgICAgICBdLFxuICAgIHNraXA6ICAxMDAwLFxuICAgIHN0ZXBzOiAxMDAwMCxcbiAgICBwb2ludF9jbG91ZDoge1xuICAgICAgICBuOiA2MDAwLFxuICAgICAgICBjOiBbMSwgMSwgMV0sXG4gICAgICAgIHI6IDAuMDUsXG4gICAgICAgIGR0OiAwLjA1LFxuICAgIH1cbn07XG5cbi8vIHNldCB0aGUgZXF1YXRpb24gZGVmaW5pdGlvbiB0byBwbG90XG5nbyhwb2ludF9jbG91ZF9kZWYpO1xuIiwib3V0cHV0IjpbXSwiZm9ybWF0dGluZ19vcHRpb25zIjp7ImFsaWduIjoibGVmdCIsImluZGVudCI6IjBlbSJ9fV19
</div>
</body>
</html>
